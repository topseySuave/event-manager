{"version":3,"file":"./hot/hot-update.js","sources":["webpack:///client/src/actions/events-actions/index.js"],"sourcesContent":["import { dispatch } from 'redux';\nimport axios from 'axios';\nimport {\n  FETCH_EVENTS,\n  ADD_EVENT,\n  EDIT_EVENT,\n  EDIT_EVENT_REQUEST,\n  EDIT_EVENT_FAILURE,\n  REMOVE_EVENT,\n  LOADMORE_EVENT_REQUEST,\n  LOADMORE_EVENT_SUCCESS,\n  LOADMORE_EVENT_FAILURE,\n  SEARCH_EVENT_TITLE,\n  SESSION_EVENTS,\n  SESSION_EVENTS_FAILURE,\n  EVENT_STATUS_CHANGE,\n  ADD_EVENT_FAILURE\n} from '../';\nimport setAuthorizationToken from\n  '../../components/authentication/setAuthenticationToken';\n\n\n/**\n *  @API Route String\n * * */\nconst api = '/api/v1/events';\n\n/* *\n *  @Event Dispatch Method\n *  @Returns Object\n * * */\nexport const eventsDispatchAction = (type, data = {}) => {\n  switch (type) {\n    case 'edit':\n      return {\n        type: EDIT_EVENT,\n        payload: data\n      };\n\n    case 'edit_request':\n      return {\n        type: EDIT_EVENT_REQUEST,\n        payload: data\n      };\n\n    case 'add':\n      return {\n        type: ADD_EVENT,\n        payload: data\n      };\n\n    case 'fetch':\n      return {\n        type: FETCH_EVENTS,\n        payload: data\n      };\n\n    case 'delete':\n      return {\n        type: REMOVE_EVENT,\n        payload: data\n      };\n\n    case 'failure':\n      return {\n        type: ADD_EVENT_FAILURE\n      };\n\n    case 'EDIT_EVENT_FAILURE':\n      return {\n        type: EDIT_EVENT_FAILURE\n      };\n\n    case 'SESSION_EVENTS':\n      return {\n        type: SESSION_EVENTS,\n        payload: data\n      };\n\n    case 'SESSION_EVENTS_FAILURE':\n      return {\n        type: SESSION_EVENTS_FAILURE\n      };\n\n    case 'EVENT_STATUS_CHANGE':\n      return {\n        type: EVENT_STATUS_CHANGE\n      };\n\n    case 'LOADMORE_EVENT_REQUEST':\n      return {\n        type: LOADMORE_EVENT_REQUEST\n      };\n\n    case 'LOADMORE_EVENT_SUCCESS':\n      return {\n        type: LOADMORE_EVENT_SUCCESS,\n        payload: data\n      };\n\n    case 'LOADMORE_EVENT_FAILURE':\n      return {\n        type: LOADMORE_EVENT_FAILURE\n      };\n\n    default:\n      return data;\n  }\n};\n\nexport const searchEventsDispatch = data => ({\n  type: SEARCH_EVENT_TITLE,\n  events: data\n});\n\nexport const createEvent = (eventData, imgUrl) => (dispatch) => {\n  let token = localStorage.getItem('jwtToken') ? localStorage\n    .getItem('jwtToken') : false;\n  setAuthorizationToken(token);\n  eventData.img_url = imgUrl;\n  return axios.post(api, eventData)\n    .then(({ data }) => {\n      if (data.statusCode === 400) {\n        Materialize.toast(data.message, 5000, 'red lighten-2');\n        dispatch(eventsDispatchAction('failure'));\n      } else {\n        dispatch(eventsDispatchAction('add', data.event));\n        Materialize.toast(data.message, 5000, 'teal lighten-2');\n      }\n    })\n    .catch((err) => {\n      dispatch(eventsDispatchAction('EDIT_EVENT_FAILURE'));\n      Materialize.toast('An Error Occurred..!!!', 5000, 'red lighten-2');\n    });\n};\n\n/* *\n *  Initial Create Event Request Action\n *  @Returns Promise\n * * */\nexport const createEventRequest = eventData => (dispatch) => {\n  if (eventData.img_url.name) {\n    let formData = new FormData();\n    formData.append('file', eventData.img_url);\n    formData.append('upload_preset', process.env.CLOUDINARY_UPLOAD_PRESET);\n    setAuthorizationToken(false);\n    return axios.post(process.env.CLOUDINARY_URL, formData)\n      .then(({ data }) => {\n        dispatch(createEvent(eventData, data.url));\n      })\n      .catch((err) => {\n        Materialize.toast('Error in connection', 5000, 'red lighten-2');\n      });\n  }\n\n  return dispatch(createEvent(eventData, ''));\n};\n\n\n/**\n *  @Fetch Event Action\n *  @Returns Object\n * * */\nexport const fetchEventRequest = () => dispatch => axios.get(api)\n  .then(({ data }) => {\n    data.loadingmore = false;\n    data.loadmore = false;\n    data.isLoading = false;\n    dispatch(eventsDispatchAction('fetch', data));\n  });\n\nexport const fetchSessionEventRequest = userId => dispatch => axios\n  .get(`${api}?sessionEvents=${userId}`)\n  .then(({ data }) => {\n    data.isLoading = false;\n    if (data) {\n      return dispatch(eventsDispatchAction('SESSION_EVENTS', data));\n    }\n    return dispatch(eventsDispatchAction('SESSION_EVENTS_FAILURE'));\n  });\n\n/* *\n *  @Edit Event Request Action\n *  @Returns Object\n * * */\nexport const editEventRequestAction = data => dispatch =>\n  dispatch(eventsDispatchAction('edit_request', data));\n\nconst editEvent = (eventData, imgUrl) => (dispatch) => {\n  let token = localStorage.getItem('jwtToken') ? localStorage\n    .getItem('jwtToken') : false;\n  setAuthorizationToken(token);\n  eventData.img_url = imgUrl;\n  return axios.put(`${api}/${eventData.eventId}`, eventData)\n    .then(({ data }) => {\n      if (data.statusCode === 201) {\n        Materialize.toast(data.message, 5000, 'teal lighten-2');\n        $('#add_event_modal').modal('close');\n        $('.body__holdr').removeClass('blur__fits');\n        return dispatch(eventsDispatchAction('edit', data.event));\n      }\n      return data;\n    });\n};\n\n/* *\n *  @Edit Event Action\n *  @Returns Object\n * * */\nexport const editEventAction = eventData => (dispatch) => {\n  if (eventData.img_url.name) {\n    let formData = new FormData();\n    formData.append('file', eventData.img_url);\n    formData.append('upload_preset', process.env.CLOUDINARY_UPLOAD_PRESET);\n    setAuthorizationToken(false);\n    return axios.post(process.env.CLOUDINARY_URL, formData)\n      .then(({ data }) => {\n        dispatch(editEvent(eventData, data.url));\n      })\n      .catch(() => {\n        Materialize.toast('Error in connection', 5000, 'red lighten-2');\n      });\n  }\n  return dispatch(editEvent(eventData, eventData.img_url));\n};\n\n/* *\n *  @Delete Event Action\n *  @Returns Object\n * * */\nexport const deleteEventRequest = (id) => {\n  id = parseInt(id, 10);\n  return dispatch => axios.delete(`${api}/${id}`)\n    .then(({ data }) => {\n      if (data.statusCode === 200) {\n        Materialize.toast(data.message, 5000, 'teal lighten-2');\n        return dispatch(eventsDispatchAction('delete', data.event));\n      }\n      Materialize.toast(data.message, 5000, 'red lighten-2');\n      return data;\n    });\n};\n\n/* *\n *  @Load more Event Request Action\n *  @Returns Object\n * * */\nexport const loadMoreEvents = (userId, offset) => (dispatch) => {\n  dispatch(eventsDispatchAction('LOADMORE_EVENT_REQUEST'));\n  return axios.get(`${api}?sessionEvents=${userId}&next=${offset}`)\n    .then(({ data }) => {\n      if (data.statusCode === 200) {\n        return dispatch(eventsDispatchAction('LOADMORE_EVENT_SUCCESS', data\n          .events));\n      }\n      return dispatch(eventsDispatchAction('LOADMORE_EVENT_FAILURE'));\n    });\n};\n\n/* *\n * Accept a pending event\n * */\nexport const handleStatusEventAction = (eventId, status) => dispatch =>\n  // send status request for event\n  axios.post(`${api}/${eventId}?status=${status}`)\n    .then(({ data }) => {\n      if (data.statusCode === 200) {\n        Materialize.toast(data.message, 5000, 'teal lighten-2');\n        return dispatch(eventsDispatchAction('EVENT_STATUS_CHANGE'));\n      }\n      Materialize.toast(data.message, 5000, 'red lighten-2');\n    });\n\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AACA;;;AAAA;AACA;AAeA;AACA;;;;;;;AAGA;;;AAGA;AACA;AACA;;;;AAIA;AAAA;AACA;AAAA;AACA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AACA;AAGA;;AACA;AAAA;AACA;AAGA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AACA;AAGA;;AACA;AAAA;AACA;AAGA;;AACA;AAAA;AACA;AAGA;;AACA;AAAA;AAAA;AACA;AAIA;;AACA;AAAA;AACA;AAIA;AA1EA;;AADA;AACA;AA8EA;;AAAA;AAAA;AAAA;AAAA;AACA;AAIA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AATA;AAWA;AACA;AAZA;AALA;AAAA;AACA;AAoBA;;;;AAIA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAFA;AAKA;AALA;AASA;AACA;AADA;AAfA;AAAA;AACA;AAkBA;;;;AAIA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AALA;AAAA;AAAA;AACA;AAOA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AAPA;AAAA;AAAA;AACA;AASA;;;;AAIA;AAAA;AACA;AADA;AAAA;AACA;AAEA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAAA;AARA;AALA;AAAA;AACA;AAgBA;;;;AAIA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAFA;AAKA;AALA;AAQA;AAAA;AAdA;AAAA;AACA;AAgBA;;;;AAIA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AACA;AAPA;AAAA;AAFA;AACA;AAYA;;;;AAIA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AAAA;AANA;AAFA;AAAA;AACA;AAWA;;;AAGA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AARA;;AAAA;AAAA;;;;A","sourceRoot":""}